<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover, interactive-widget=overlays-content"
    />
    <meta name="theme-color" content="#1e1e2e" />
    <title>C2P Controller</title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="stylesheet" href="/vendor/xterm.css" />
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <div class="app">
      <header class="status-bar" aria-label="连接状态">
        <div class="status-indicators">
          <span id="control-signal" class="signal is-offline" aria-label="Control status"></span>
          <span class="signal-label">Control</span>
          <span id="terminal-signal" class="signal is-offline" aria-label="Terminal status"></span>
          <span class="signal-label">Terminal</span>
        </div>
        <div class="status-main">
          <p id="status-text" class="status-text">未连接</p>
          <p class="cwd-text">目录 <span id="cwd-text">-</span></p>
        </div>
        <button id="session-pill" class="session-pill" type="button" hidden title="复制会话 ID">
          会话 -
        </button>
      </header>

      <main class="workspace" aria-label="工作区">
        <section id="terminal-wrap" aria-label="终端区域">
          <div id="terminal-reconnect" class="terminal-reconnect" hidden>
            <p id="terminal-reconnect-text" class="terminal-reconnect-text"></p>
            <div class="terminal-reconnect-track" role="progressbar" aria-valuemin="0" aria-valuemax="100">
              <span id="terminal-reconnect-fill" class="terminal-reconnect-fill"></span>
            </div>
          </div>
          <p class="terminal-input-hint">提示：新版直接在终端面板内输入，手机先点终端区域再调出键盘。</p>
          <div id="terminal-grid" class="terminal-grid" aria-live="polite"></div>
        </section>
      </main>

      <section id="dock" class="dock" aria-label="底部控制坞">
        <div id="session-tabs" class="session-tabs" role="tablist" aria-label="活跃会话" hidden></div>

        <div id="quick-keys" class="quick-keys" role="group" aria-label="快捷键"></div>

        <button id="dock-handle" class="dock-handle" type="button" aria-expanded="false">
          控制面板
        </button>

        <div id="dock-panel" class="dock-panel">
          <section class="dock-card files-card" aria-label="文件管理">
            <header class="dock-card-header">
              <h3 class="dock-card-title">文件管理</h3>
              <code id="files-path" class="files-path">.</code>
            </header>
            <div class="files-toolbar">
              <button id="files-up-btn" class="btn" type="button">上级</button>
              <button id="files-refresh-btn" class="btn" type="button">刷新</button>
              <button id="files-mkdir-btn" class="btn" type="button">新建目录</button>
              <button id="files-upload-btn" class="btn" type="button">上传</button>
              <input id="files-upload-input" type="file" multiple hidden />
            </div>
            <div id="files-list" class="files-list" aria-live="polite"></div>
            <div id="files-editor-wrap" class="files-editor-wrap" hidden>
              <p class="files-editor-path">
                编辑: <code id="files-editor-path"></code>
              </p>
              <textarea id="files-editor" class="files-editor" spellcheck="false"></textarea>
              <div class="files-editor-actions">
                <button id="files-editor-save-btn" class="btn" type="button">保存</button>
                <button id="files-editor-cancel-btn" class="btn" type="button">关闭</button>
              </div>
            </div>
          </section>

          <section id="monitor-panel" class="dock-card monitor-card" aria-label="系统监控">
            <header class="dock-card-header">
              <h3 class="dock-card-title">系统监控</h3>
              <span id="monitor-updated-at" class="monitor-updated-at">--:--:--</span>
            </header>
            <div class="monitor-item">
              <span class="monitor-label">CPU</span>
              <div class="monitor-meter"><span id="monitor-cpu-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-cpu-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-item">
              <span class="monitor-label">内存</span>
              <div class="monitor-meter"><span id="monitor-memory-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-memory-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-item">
              <span class="monitor-label">磁盘</span>
              <div class="monitor-meter"><span id="monitor-disk-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-disk-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-inline">
              <span id="monitor-net-rx-text">↓ -</span>
              <span id="monitor-net-tx-text">↑ -</span>
              <span id="monitor-uptime-text">-</span>
              <span id="monitor-vnc-text">离线</span>
            </div>
            <div class="monitor-item monitor-quality-item">
              <span class="monitor-label">CQS</span>
              <span id="monitor-cqs-text" class="monitor-value monitor-quality-pill">离线</span>
            </div>
            <div class="monitor-inline">
              <span id="monitor-rtt-text">RTT -</span>
              <span id="monitor-jitter-text">抖动 -</span>
              <span id="monitor-loss-text">丢包 -</span>
              <span id="monitor-profile-text">桌面档位 balanced</span>
            </div>
            <label class="telemetry-toggle">
              <input id="telemetry-opt-in" type="checkbox" />
              启用匿名遥测（可选）
            </label>
          </section>
        </div>
      </section>

    </div>

    <div id="toast-root" class="toast-root" aria-live="polite" aria-atomic="true"></div>

    <script src="/vendor/xterm.js"></script>
    <script src="/vendor/xterm-addon-fit.js"></script>
    <script src="/vendor/xterm-addon-webgl.js"></script>
    <script type="module" src="/app.js"></script>
  </body>
</html>
