<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=yes, maximum-scale=5, interactive-widget=resizes-content"
    />
    <meta name="theme-color" content="#1e1e2e" />
    <title>C2P Controller</title>
    <link rel="manifest" href="/manifest.json" />
    <link rel="stylesheet" href="/vendor/xterm.css" />
    <link rel="stylesheet" href="/tokens.css" />
    <link rel="stylesheet" href="/style.css" />
    <link id="hljs-theme" rel="stylesheet" href="/vendor/hljs/github.min.css" />
  </head>
  <body>
    <div class="app">
      <header class="status-bar" aria-label="连接状态">
        <div class="status-indicators">
          <span id="control-signal" class="signal is-offline" aria-label="Control status"></span>
          <span class="signal-label">Control</span>
          <span id="terminal-signal" class="signal is-offline" aria-label="Terminal status"></span>
          <span class="signal-label">Terminal</span>
        </div>
        <div class="status-main">
          <p id="status-text" class="status-text">未连接</p>
          <p class="cwd-text">目录 <span id="cwd-text">-</span></p>
        </div>
        <button id="session-pill" class="session-pill" type="button" hidden title="复制会话 ID">
          会话 -
        </button>
      </header>

      <main class="workspace" aria-label="工作区">
        <section id="terminal-wrap" aria-label="终端区域">
          <div id="terminal-reconnect" class="terminal-reconnect" hidden>
            <p id="terminal-reconnect-text" class="terminal-reconnect-text"></p>
            <div class="terminal-reconnect-track" role="progressbar" aria-valuemin="0" aria-valuemax="100">
              <span id="terminal-reconnect-fill" class="terminal-reconnect-fill"></span>
            </div>
          </div>
          <div id="terminal-grid" class="terminal-grid" aria-live="polite"></div>
        </section>
      </main>

      <section id="dock" class="dock" aria-label="底部控制坞">
        <div id="session-tabs" class="session-tabs" role="tablist" aria-label="活跃会话" hidden></div>

        <button
          id="quick-keys-toggle"
          class="quick-keys-toggle"
          type="button"
          aria-controls="quick-keys"
          aria-expanded="false"
          aria-pressed="false"
        >
          ⌨
        </button>

        <div id="quick-keys" class="quick-keys" role="group" aria-label="快捷键"></div>

        <button id="dock-handle" class="dock-handle" type="button" aria-expanded="false">
          控制面板
        </button>

        <div id="dock-panel" class="dock-panel">
          <section class="dock-card files-card" aria-label="文件管理">
            <header class="dock-card-header">
              <div class="dock-card-heading">
                <h3 class="dock-card-title">文件管理</h3>
                <span id="files-scope-pill" class="scope-pill" hidden>只读</span>
              </div>
              <code id="files-path" class="files-path">.</code>
            </header>
            <div class="files-toolbar">
              <button id="files-up-btn" class="btn" type="button" title="上级目录" aria-label="上级目录">
                <span class="files-tool-icon">↑</span>
                <span class="files-tool-label">上级</span>
              </button>
              <button id="files-root-btn" class="btn" type="button" title="根目录" aria-label="根目录">
                <span class="files-tool-icon">⌂</span>
                <span class="files-tool-label">根目录</span>
              </button>
              <button id="files-refresh-btn" class="btn" type="button" title="刷新" aria-label="刷新">
                <span class="files-tool-icon">⟳</span>
                <span class="files-tool-label">刷新</span>
              </button>
              <button id="files-hidden-btn" class="btn" type="button" title="隐藏隐藏文件" aria-label="隐藏隐藏文件">
                <span class="files-tool-icon">H-</span>
                <span class="files-tool-label">隐藏</span>
              </button>
              <button id="files-newfile-btn" class="btn" type="button" title="新建文件" aria-label="新建文件">
                <span class="files-tool-icon">F+</span>
                <span class="files-tool-label">文件</span>
              </button>
              <button id="files-mkdir-btn" class="btn" type="button" title="新建目录" aria-label="新建目录">
                <span class="files-tool-icon">D+</span>
                <span class="files-tool-label">目录</span>
              </button>
              <button id="files-upload-btn" class="btn" type="button" title="上传文件" aria-label="上传文件">
                <span class="files-tool-icon">⇪</span>
                <span class="files-tool-label">上传</span>
              </button>
              <input id="files-upload-input" type="file" multiple hidden />
            </div>
            <div class="files-search-bar">
              <input
                id="files-search-input"
                class="files-search-input"
                type="search"
                placeholder="搜索文件名..."
                autocomplete="off"
                spellcheck="false"
              />
            </div>
            <div id="files-list" class="files-list" aria-live="polite"></div>
          </section>

          <section id="monitor-panel" class="dock-card monitor-card" aria-label="系统监控">
            <header class="dock-card-header">
              <h3 class="dock-card-title">系统监控</h3>
              <span id="monitor-updated-at" class="monitor-updated-at">--:--:--</span>
            </header>
            <div class="monitor-item">
              <span class="monitor-label">CPU</span>
              <div class="monitor-meter"><span id="monitor-cpu-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-cpu-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-item">
              <span class="monitor-label">内存</span>
              <div class="monitor-meter"><span id="monitor-memory-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-memory-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-item">
              <span class="monitor-label">磁盘</span>
              <div class="monitor-meter"><span id="monitor-disk-fill" class="monitor-meter-fill"></span></div>
              <span id="monitor-disk-text" class="monitor-value">-</span>
            </div>
            <div class="monitor-inline">
              <span id="monitor-net-rx-text">↓ -</span>
              <span id="monitor-net-tx-text">↑ -</span>
              <span id="monitor-uptime-text">-</span>
            </div>
            <div class="monitor-item monitor-quality-item">
              <span class="monitor-label">
                CQS
                <span class="monitor-label-note">连接质量</span>
              </span>
              <span id="monitor-cqs-text" class="monitor-value monitor-quality-pill">离线</span>
            </div>
            <div class="monitor-inline">
              <span id="monitor-rtt-text">RTT -</span>
              <span id="monitor-jitter-text">抖动 -</span>
              <span id="monitor-loss-text">丢包 -</span>
              <span id="monitor-profile-text">桌面档位 balanced</span>
            </div>
          </section>

          <section id="appearance-panel" class="dock-card appearance-card" aria-label="外观设置">
            <header class="dock-card-header">
              <h3 class="dock-card-title">外观设置</h3>
            </header>
            <div class="pref-grid" role="group" aria-label="外观偏好">
              <label class="pref-row">
                <span class="pref-label">主题</span>
                <select id="pref-theme" class="pref-select" aria-label="主题偏好">
                  <option value="system">跟随系统</option>
                  <option value="dark">深色</option>
                  <option value="light">浅色</option>
                </select>
              </label>
              <label class="pref-row">
                <span class="pref-label">高对比</span>
                <select id="pref-contrast" class="pref-select" aria-label="高对比偏好">
                  <option value="system">跟随系统</option>
                  <option value="more">开启</option>
                  <option value="normal">关闭</option>
                </select>
              </label>
              <label class="pref-row">
                <span class="pref-label">减少动效</span>
                <select id="pref-motion" class="pref-select" aria-label="减少动效偏好">
                  <option value="system">跟随系统</option>
                  <option value="reduce">开启</option>
                  <option value="normal">关闭</option>
                </select>
              </label>
              <label class="pref-row">
                <span class="pref-label">降低透明度</span>
                <select id="pref-transparency" class="pref-select" aria-label="降低透明度偏好">
                  <option value="normal">关闭</option>
                  <option value="reduce">开启</option>
                </select>
              </label>
            </div>
          </section>
        </div>
      </section>

    </div>

    <div id="toast-root" class="toast-root" aria-live="polite" aria-atomic="true"></div>
    <dialog id="files-editor-dialog" class="file-dialog">
      <div class="file-dialog-header">
        <span id="files-editor-path" class="file-dialog-title"></span>
        <div class="file-dialog-actions">
          <button id="files-md-toggle-btn" class="btn btn-sm" type="button" hidden>预览</button>
          <button id="files-editor-save-btn" class="btn btn-sm" type="button">保存</button>
          <button id="files-editor-cancel-btn" class="btn btn-sm" type="button" aria-label="关闭">✕</button>
        </div>
      </div>
      <div class="file-dialog-body">
        <textarea id="files-editor" class="files-editor" spellcheck="false"></textarea>
        <div id="files-md-preview" class="files-md-preview" hidden></div>
        <div id="files-img-preview" class="files-img-preview" hidden></div>
      </div>
    </dialog>

    <script src="/vendor/xterm.js"></script>
    <script src="/vendor/xterm-addon-fit.js"></script>
    <script src="/vendor/xterm-addon-webgl.js"></script>
    <script src="/vendor/marked.min.js"></script>
    <script src="/vendor/hljs/highlight.min.js"></script>
    <script type="module" src="/app.js"></script>
  </body>
</html>
