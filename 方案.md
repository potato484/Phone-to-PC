╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌
 C2P Controller UI 美化与性能优化方案                                          

 Context

 C2P Controller 是一个移动优先的远程终端控制 Web 应用（Vanilla JS +
 xterm.js），当前采用冷蓝色调暗色主题。用户希望提升视觉美感、人机交互舒适度，并附带 CSS 层面的性能优化。

 基于对 Catppuccin Mocha 色彩体系、Glassmorphism 设计趋势、微交互最佳实践、CSS Containment
 性能优化等方向的网络调研，制定以下 4 阶段方案。

 改动文件
 ┌────────────────────┬────────────────────────────────────────────┐
 │        文件        │                  改动类型                  │
 ├────────────────────┼────────────────────────────────────────────┤
 │ public/style.css   │ 主要 — 全部 CSS 变更                       │
 ├────────────────────┼────────────────────────────────────────────┤
 │ public/lib/term.js │ 小改 — xterm.js 主题对象扩展 (第633-636行) │
 ├────────────────────┼────────────────────────────────────────────┤
 │ public/index.html  │ 微改 — theme-color meta 标签 (第9行)       │
 └────────────────────┴────────────────────────────────────────────┘
 后端代码、JS 逻辑、HTML 结构均不变。

 ---
 Phase 1: 色彩系统升级

 1.1 CSS 自定义属性迁移 (style.css :root)

 从冷蓝色调迁移到 Catppuccin Mocha 暖色调：

 :root {
   --bg: #1e1e2e;
   --bg-deep: #11111b;
   --surface: #181825;
   --surface-high: #313244;
   --surface-higher: #45475a;
   --text: #cdd6f4;
   --text-muted: #a6adc8;
   --text-subtle: #6c7086;
   --border: #313244;
   --border-subtle: rgba(205, 214, 244, 0.08);
   --accent: #94e2d5;
   --accent-dim: rgba(148, 226, 213, 0.15);
   --accent-glow: rgba(148, 226, 213, 0.4);
   --danger: #f38ba8;
   --danger-dim: rgba(243, 139, 168, 0.15);
   --warning: #f9e2af;
   --warning-dim: rgba(249, 226, 175, 0.15);
   --success: #a6e3a1;
   --info: #89b4fa;
   --mauve: #cba6f7;
   --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
   --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
   --ease-standard: cubic-bezier(0.4, 0, 0.2, 1);
 }

 1.2 xterm.js 完整 ANSI 主题 (term.js 第633-636行)

 当前仅 background + foreground，扩展为完整 16 色 + cursor + selection：

 theme: {
   background: '#1e1e2e',
   foreground: '#cdd6f4',
   cursor: '#f5e0dc',
   cursorAccent: '#1e1e2e',
   selectionBackground: 'rgba(148, 226, 213, 0.2)',
   selectionForeground: '#cdd6f4',
   black: '#45475a', red: '#f38ba8', green: '#a6e3a1',
   yellow: '#f9e2af', blue: '#89b4fa', magenta: '#cba6f7',
   cyan: '#94e2d5', white: '#bac2de',
   brightBlack: '#585b70', brightRed: '#f38ba8', brightGreen: '#a6e3a1',
   brightYellow: '#f9e2af', brightBlue: '#89b4fa', brightMagenta: '#cba6f7',
   brightCyan: '#94e2d5', brightWhite: '#a6adc8'
 }

 1.3 硬编码颜色全局替换 (style.css)

 将所有散落的硬编码 hex 值统一为 CSS 变量引用：
 - #14192f / #141833 / #1a1f3a → var(--surface)
 - #202744 → var(--surface-high)
 - #343a54 / #363c55 / #3a3f5c → var(--border) 或 var(--surface-higher)
 - #57617f / #46506e / #4f5f7e / #5b6277 → var(--text-subtle)
 - #070b18 / #090b14 → var(--bg-deep)
 - 旧 accent #36c7a4 / rgba(54, 199, 164, ...) → var(--accent) / var(--accent-dim) / var(--accent-glow)

 1.4 HTML theme-color 同步 (index.html 第9行)

 #1a1a2e → #1e1e2e

 ---
 Phase 2: 视觉精修

 2.1 增强 Glassmorphism

 - .status-bar: backdrop-filter: blur(16px), 背景 rgba(24, 24, 37, 0.78), 边框 var(--border-subtle)
 - .dock: backdrop-filter: blur(16px), 背景 rgba(24, 24, 37, 0.85)
 - .touch-context-menu: backdrop-filter: blur(20px), 多层阴影
 - .dock-card: 添加 backdrop-filter: blur(8px), 背景 rgba(17, 17, 27, 0.6)

 2.2 阴影深度层级

 - .terminal-pane: 双层阴影 0 2px 8px rgba(0,0,0,0.2), 0 12px 24px rgba(0,0,0,0.15)
 - .terminal-pane.is-active: accent 外发光 0 0 0 1px rgba(148,226,213,0.15) + 双层阴影
 - .toast: 增强阴影 + 微妙外边框

 2.3 信号灯脉冲动画

 @keyframes signal-pulse {
   0%, 100% { box-shadow: 0 0 6px var(--accent-glow); }
   50%      { box-shadow: 0 0 12px var(--accent-glow), 0 0 4px var(--accent-glow); }
 }
 .signal.is-online { animation: signal-pulse 2.4s ease-in-out infinite; }

 2.4 Toast 左边框语义色

 默认 border-left-color: var(--info), danger/warn/success 各用对应语义色。

 2.5 监控仪表条

 渐变使用 var(--accent), 添加 transition: width 400ms var(--ease-out) 平滑过渡。

 ---
 Phase 3: 微交互与舒适度

 3.1 Spring 缓动按钮反馈

 - button 默认态: transition: transform 180ms var(--ease-out), border-color 180ms var(--ease-standard)
 - button:active: transform: scale(0.95), transition: transform 100ms var(--ease-spring)
 - .quick-key-btn:active: transform: scale(0.92), spring 缓动

 3.2 Dock 展开动画

 .dock-panel 过渡改用 spring 缓动: transform 280ms var(--ease-spring)

 3.3 Session Tab 交互

 - 添加 focus-visible 轮廓: outline: 2px solid var(--accent)
 - .is-active 使用 var(--accent-dim) 背景

 3.4 Toast 动画增强

 入场添加 scale(0.96) → scale(1) 弹性效果，使用 var(--ease-spring) 缓动。

 3.5 prefers-reduced-motion 支持

 @media (prefers-reduced-motion: reduce) {
   *, *::before, *::after {
     animation-duration: 0.01ms !important;
     animation-iteration-count: 1 !important;
     transition-duration: 0.01ms !important;
   }
 }

 ---
 Phase 4: 性能优化

 4.1 CSS Containment

 - .terminal-pane: contain: layout style
 - .dock-card: contain: layout style
 - .files-list: contain: layout paint style
 - .session-tabs: contain: layout style

 4.2 content-visibility

 - .dock-panel: content-visibility: auto; contain-intrinsic-size: 0 500px（收起时跳过渲染）

 4.3 will-change（仅动画元素）

 - .dock-panel: will-change: opacity, transform
 - .toast: will-change: opacity, transform
 - .session-tab: will-change: transform

 4.4 动画属性约束

 确保所有 transition 仅作用于 transform、opacity、border-color、background 等合成友好属性。进度条 width
 transition 保留（功能必需）。

 ---
 Phase 5: 补全与深度优化 (补充)

 5.1 PWA 主题适配 (manifest.json)

 确保 PWA 安装后的系统栏颜色与应用一致：

 {
   "background_color": "#1e1e2e",
   "theme_color": "#1e1e2e"
 }

 5.2 低性能模式降级 (style.css)

 针对低端设备（通过 prefers-reduced-motion 触发）移除高开销的毛玻璃效果：

 @media (prefers-reduced-motion: reduce) {
   .status-bar, .dock, .touch-context-menu, .dock-card, .terminal-reconnect {
     backdrop-filter: none !important;
     -webkit-backdrop-filter: none !important;
     background: var(--surface-high) !important; /* 不透明回退色 */
   }
 }

 5.3 辅助页面统一 (reset-cache.html)

 统一缓存重置页面的视觉风格，避免跳转时闪瞎眼：

 <style>
   body { background: #1e1e2e; color: #cdd6f4; font-family: system-ui, sans-serif; }
   .btn { background: #313244; border: 1px solid #45475a; color: #cdd6f4; }
 </style>

 ---
 风险与缓解

 1. xterm WebGL addon 对 rgba selectionBackground 的兼容性 → 实测验证
 2. backdrop-filter: blur(16px) 在低端安卓可能卡顿 → prefers-reduced-motion 降级
 3. content-visibility: auto 影响 dock-panel 展开首帧 → contain-intrinsic-size 估值需实测
 4. 色彩迁移后对比度 → Catppuccin Mocha 已通过社区验证，text/bg 对比度 > 7:1

 验证方式

 1. 移动端 Chrome/Safari 真机测试：终端输入输出、会话切换、手势操作
 2. 桌面端 900px+ 布局验证
 3. 检查 xterm.js 终端内 ls --color、htop 等彩色输出的 ANSI 色彩渲染
 4. 验证 dock 展开/收起动画流畅度
 5. 验证 prefers-reduced-motion 下动画正确禁用
 6. Chrome DevTools Performance 面板检查 Layout/Paint 频率
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌